I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcublas.so.7.0 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcudnn.so.6.5 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcufft.so.7.0 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcuda.so locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcurand.so.7.0 locally
I tensorflow/core/common_runtime/local_device.cc:40] Local device intra op parallelism threads: 24
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:909] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_init.cc:103] Found device 0 with properties: 
name: GeForce GTX 980
major: 5 minor: 2 memoryClockRate (GHz) 1.2155
pciBusID 0000:81:00.0
Total memory: 4.00GiB
Free memory: 3.91GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:127] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:137] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Allocating 3.62GiB bytes.
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:52] GPU 0 memory begins at 0x1304980000 extends to 0x13ec1a3000
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 8.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 16.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 32.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 64.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 128.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 256.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 512.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 8.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 16.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 32.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 64.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 128.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 256.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 512.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.00GiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.00GiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.00GiB
I tensorflow/core/common_runtime/direct_session.cc:58] Direct session inter op parallelism threads: 24
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
('Extracting', '../datasets/train-labels-idx1-ubyte.gz')
{'learn_rate': 0.01, 'class_label': 0, 'gradient': 'gradient', 'activation': 'sigmoid', 'n_batch': 5, 'batch': False, 'iters': 1000, 'hidden': 10, 'model_name': './model.ckpt'}
Pre-training with RBM layer  1 ...
...Done
Pre-training with RBM layer  2 ...
...Done
[array([[-75.45308685, -76.04803467, -76.3760376 , ..., -75.71250916,
        -77.9575882 , -75.80111694],
       [-74.71282959, -75.39671326, -75.98566437, ..., -74.73271179,
        -76.97285461, -75.02342987],
       [-76.58011627, -77.01106262, -77.77994537, ..., -77.32624054,
        -79.12779236, -77.28509521],
       ..., 
       [-75.05701447, -75.48031616, -75.66410065, ..., -74.45752716,
        -77.14505005, -75.23362732],
       [-73.2099762 , -73.64395142, -73.77628326, ..., -72.02490997,
        -74.89335632, -73.14471436],
       [-74.67902374, -75.31880951, -75.34374237, ..., -74.16830444,
        -76.82319641, -75.01512146]], dtype=float32), array([[ 1.90097046, -0.14716057,  2.10835695, ...,  0.02114528,
         2.56783271,  0.45351502],
       [ 4.07752132, -0.46231067,  5.04460716, ..., -0.65374154,
         4.06638861,  2.4495008 ],
       [ 2.1938827 , -0.35657224,  2.27374911, ..., -1.14541173,
         2.559201  ,  0.68925321],
       ..., 
       [ 3.13725209,  0.35008422,  2.89425921, ..., -0.86965322,
         3.55709076,  1.09945154],
       [ 4.09133291,  0.02407707,  4.46050787, ..., -0.07017596,
         3.72986674,  1.97175169],
       [ 4.26218605,  0.17645909,  4.83876896, ..., -0.44836861,
         4.01419973,  2.91566229]], dtype=float32), array([[ 1.90097046,  4.07752132,  2.1938827 , ...,  3.13725209,
         4.09133291,  4.26218605],
       [-0.14716057, -0.46231067, -0.35657224, ...,  0.35008422,
         0.02407707,  0.17645909],
       [ 2.10835695,  5.04460716,  2.27374911, ...,  2.89425921,
         4.46050787,  4.83876896],
       ..., 
       [ 0.02114528, -0.65374154, -1.14541173, ..., -0.86965322,
        -0.07017596, -0.44836861],
       [ 2.56783271,  4.06638861,  2.559201  , ...,  3.55709076,
         3.72986674,  4.01419973],
       [ 0.45351502,  2.4495008 ,  0.68925321, ...,  1.09945154,
         1.97175169,  2.91566229]], dtype=float32), array([[-75.45308685, -74.71282959, -76.58011627, ..., -75.05701447,
        -73.2099762 , -74.67902374],
       [-76.04803467, -75.39671326, -77.01106262, ..., -75.48031616,
        -73.64395142, -75.31880951],
       [-76.3760376 , -75.98566437, -77.77994537, ..., -75.66410065,
        -73.77628326, -75.34374237],
       ..., 
       [-75.71250916, -74.73271179, -77.32624054, ..., -74.45752716,
        -72.02490997, -74.16830444],
       [-77.9575882 , -76.97285461, -79.12779236, ..., -77.14505005,
        -74.89335632, -76.82319641],
       [-75.80111694, -75.02342987, -77.28509521, ..., -75.23362732,
        -73.14471436, -75.01512146]], dtype=float32)]
