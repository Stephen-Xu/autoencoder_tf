I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcublas.so.7.0 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcudnn.so.6.5 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcufft.so.7.0 locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcuda.so locally
I tensorflow/stream_executor/dso_loader.cc:101] successfully opened CUDA library libcurand.so.7.0 locally
I tensorflow/core/common_runtime/local_device.cc:40] Local device intra op parallelism threads: 24
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:909] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_init.cc:103] Found device 0 with properties: 
name: GeForce GTX 980
major: 5 minor: 2 memoryClockRate (GHz) 1.2155
pciBusID 0000:81:00.0
Total memory: 4.00GiB
Free memory: 3.91GiB
I tensorflow/core/common_runtime/gpu/gpu_init.cc:127] DMA: 0 
I tensorflow/core/common_runtime/gpu/gpu_init.cc:137] 0:   Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:42] Allocating 3.62GiB bytes.
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:52] GPU 0 memory begins at 0x1304980000 extends to 0x13ec1a3000
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 8.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 16.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 32.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 64.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 128.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 256.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 512.0KiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 8.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 16.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 32.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 64.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 128.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 256.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 512.00MiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 1.00GiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 2.00GiB
I tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:66] Creating bin of max chunk size 4.00GiB
I tensorflow/core/common_runtime/direct_session.cc:58] Direct session inter op parallelism threads: 24
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:702] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 980, pci bus id: 0000:81:00.0)
('Extracting', '../datasets/train-labels-idx1-ubyte.gz')
{'learn_rate': '0.000125', 'class_label': 0, 'gradient': 'adam', 'activation': 'sigmoid', 'n_batch': '1000', 'batch': '1', 'pre_learn_rate': '0.00001', 'iters': '5000', 'hidden': '20', 'model_name': './model_sigmoid_10_batch1000_class0_sym_regweights.ckpt'}
Pre-training with RBM layer  1 ...
...Done
Pre-training with RBM layer  2 ...
...Done
cost  102.466  at iter  1
Best model found so far at iter: 1 with cost 102.465622
cost  27.7311  at iter  2
Best model found so far at iter: 2 with cost 27.731079
cost  7.41814  at iter  3
Best model found so far at iter: 3 with cost 7.418145
cost  3.97424  at iter  4
Best model found so far at iter: 4 with cost 3.974240
cost  1.93027  at iter  5
Best model found so far at iter: 5 with cost 1.930270
cost  0.636338  at iter  6
Best model found so far at iter: 6 with cost 0.636338
cost  0.224667  at iter  7
Best model found so far at iter: 7 with cost 0.224667
cost  0.224611  at iter  8
Best model found so far at iter: 8 with cost 0.224611
cost  0.224702  at iter  9
cost  0.224679  at iter  10
cost  0.224602  at iter  11
Best model found so far at iter: 11 with cost 0.224602
cost  0.2246  at iter  12
Best model found so far at iter: 12 with cost 0.224600
cost  0.224582  at iter  13
Best model found so far at iter: 13 with cost 0.224582
cost  0.224576  at iter  14
Best model found so far at iter: 14 with cost 0.224576
cost  0.224557  at iter  15
Best model found so far at iter: 15 with cost 0.224557
cost  0.224561  at iter  16
cost  0.224536  at iter  17
Best model found so far at iter: 17 with cost 0.224536
cost  0.224532  at iter  18
Best model found so far at iter: 18 with cost 0.224532
cost  0.224536  at iter  19
cost  0.224528  at iter  20
Best model found so far at iter: 20 with cost 0.224528
cost  0.224509  at iter  21
Best model found so far at iter: 21 with cost 0.224509
cost  0.22454  at iter  22
cost  0.224508  at iter  23
Best model found so far at iter: 23 with cost 0.224508
cost  0.224512  at iter  24
cost  0.224504  at iter  25
Best model found so far at iter: 25 with cost 0.224504
cost  0.224514  at iter  26
cost  0.224547  at iter  27
cost  0.224518  at iter  28
cost  0.224488  at iter  29
Best model found so far at iter: 29 with cost 0.224488
cost  0.224478  at iter  30
Best model found so far at iter: 30 with cost 0.224478
cost  0.22449  at iter  31
cost  0.224491  at iter  32
cost  0.224468  at iter  33
Best model found so far at iter: 33 with cost 0.224468
cost  0.224466  at iter  34
Best model found so far at iter: 34 with cost 0.224466
cost  0.224473  at iter  35
cost  0.224477  at iter  36
cost  0.224457  at iter  37
Best model found so far at iter: 37 with cost 0.224457
cost  0.224468  at iter  38
cost  0.22447  at iter  39
cost  0.224467  at iter  40
cost  0.224466  at iter  41
cost  0.224466  at iter  42
cost  0.224465  at iter  43
cost  0.224473  at iter  44
cost  0.224455  at iter  45
Best model found so far at iter: 45 with cost 0.224455
cost  0.224461  at iter  46
cost  0.224463  at iter  47
cost  0.224448  at iter  48
Best model found so far at iter: 48 with cost 0.224448
cost  0.224448  at iter  49
Best model found so far at iter: 49 with cost 0.224448
cost  0.224446  at iter  50
Best model found so far at iter: 50 with cost 0.224446
cost  0.224447  at iter  51
cost  0.22444  at iter  52
Best model found so far at iter: 52 with cost 0.224440
cost  0.224442  at iter  53
cost  0.22444  at iter  54
cost  0.224444  at iter  55
cost  0.22444  at iter  56
Best model found so far at iter: 56 with cost 0.224440
cost  0.224448  at iter  57
cost  0.224445  at iter  58
cost  0.224446  at iter  59
cost  0.224439  at iter  60
Best model found so far at iter: 60 with cost 0.224439
cost  0.224437  at iter  61
Best model found so far at iter: 61 with cost 0.224437
cost  0.224437  at iter  62
cost  0.224433  at iter  63
Best model found so far at iter: 63 with cost 0.224433
cost  0.22444  at iter  64
cost  0.224442  at iter  65
cost  0.22444  at iter  66
cost  0.224445  at iter  67
cost  0.22443  at iter  68
Best model found so far at iter: 68 with cost 0.224430
cost  0.22443  at iter  69
cost  0.224443  at iter  70
cost  0.224434  at iter  71
cost  0.224429  at iter  72
Best model found so far at iter: 72 with cost 0.224429
cost  0.224433  at iter  73
cost  0.224426  at iter  74
Best model found so far at iter: 74 with cost 0.224426
cost  0.22443  at iter  75
cost  0.224435  at iter  76
cost  0.224425  at iter  77
Best model found so far at iter: 77 with cost 0.224425
cost  0.22442  at iter  78
Best model found so far at iter: 78 with cost 0.224420
cost  0.224425  at iter  79
cost  0.224425  at iter  80
cost  0.22443  at iter  81
cost  0.224423  at iter  82
cost  0.224425  at iter  83
cost  0.224426  at iter  84
cost  0.224429  at iter  85
cost  0.224423  at iter  86
cost  0.224424  at iter  87
cost  0.224429  at iter  88
cost  0.22443  at iter  89
cost  0.224423  at iter  90
cost  0.224423  at iter  91
cost  0.224423  at iter  92
cost  0.224429  at iter  93
cost  0.224429  at iter  94
cost  0.224424  at iter  95
cost  0.224424  at iter  96
cost  0.224423  at iter  97
cost  0.224429  at iter  98
cost  0.224423  at iter  99
cost  0.224424  at iter  100
cost  0.224427  at iter  101
cost  0.224423  at iter  102
cost  0.224421  at iter  103
cost  0.224418  at iter  104
Best model found so far at iter: 104 with cost 0.224418
cost  0.224423  at iter  105
cost  0.224421  at iter  106
cost  0.224416  at iter  107
Best model found so far at iter: 107 with cost 0.224416
cost  0.224416  at iter  108
cost  0.224415  at iter  109
Best model found so far at iter: 109 with cost 0.224415
cost  0.224414  at iter  110
Best model found so far at iter: 110 with cost 0.224414
cost  0.224413  at iter  111
Best model found so far at iter: 111 with cost 0.224413
cost  0.224419  at iter  112
cost  0.224417  at iter  113
cost  0.224417  at iter  114
cost  0.224418  at iter  115
cost  0.224415  at iter  116
cost  0.22442  at iter  117
cost  0.224419  at iter  118
cost  0.224421  at iter  119
cost  0.224418  at iter  120
cost  0.224423  at iter  121
cost  0.22442  at iter  122
cost  0.224415  at iter  123
cost  0.224422  at iter  124
cost  0.22442  at iter  125
cost  0.224418  at iter  126
cost  0.224416  at iter  127
cost  0.224417  at iter  128
cost  0.224416  at iter  129
cost  0.224418  at iter  130
cost  0.224418  at iter  131
cost  0.224417  at iter  132
cost  0.224419  at iter  133
cost  0.224417  at iter  134
cost  0.224417  at iter  135
cost  0.224419  at iter  136
cost  0.224418  at iter  137
cost  0.22442  at iter  138
cost  0.224423  at iter  139
cost  0.224419  at iter  140
cost  0.224419  at iter  141
cost  0.224421  at iter  142
cost  0.224424  at iter  143
cost  0.224423  at iter  144
cost  0.224421  at iter  145
cost  0.224422  at iter  146
cost  0.224421  at iter  147
cost  0.224424  at iter  148
cost  0.224423  at iter  149
cost  0.224428  at iter  150
cost  0.224427  at iter  151
cost  0.224429  at iter  152
cost  0.224427  at iter  153
cost  0.224431  at iter  154
cost  0.224434  at iter  155
cost  0.224433  at iter  156
cost  0.22443  at iter  157
cost  0.224431  at iter  158
cost  0.224432  at iter  159
cost  0.224435  at iter  160
cost  0.224435  at iter  161
cost  0.224435  at iter  162
cost  0.224433  at iter  163
cost  0.224434  at iter  164
cost  0.224435  at iter  165
cost  0.224433  at iter  166
cost  0.224435  at iter  167
cost  0.224434  at iter  168
cost  0.224434  at iter  169
cost  0.224435  at iter  170
cost  0.224434  at iter  171
cost  0.224434  at iter  172
cost  0.22444  at iter  173
cost  0.224436  at iter  174
cost  0.224436  at iter  175
cost  0.224437  at iter  176
cost  0.224434  at iter  177
cost  0.224439  at iter  178
cost  0.224435  at iter  179
cost  0.224435  at iter  180
cost  0.224435  at iter  181
cost  0.224435  at iter  182
cost  0.224439  at iter  183
cost  0.224436  at iter  184
cost  0.224438  at iter  185
cost  0.224437  at iter  186
cost  0.224439  at iter  187
cost  0.224439  at iter  188
cost  0.224439  at iter  189
cost  0.224439  at iter  190
cost  0.22444  at iter  191
cost  0.224439  at iter  192
cost  0.224439  at iter  193
cost  0.224438  at iter  194
cost  0.22444  at iter  195
cost  0.224439  at iter  196
cost  0.224441  at iter  197
cost  0.22444  at iter  198
cost  0.224439  at iter  199
cost  0.224441  at iter  200
cost  0.224437  at iter  201
cost  0.224438  at iter  202
cost  0.22444  at iter  203
cost  0.224437  at iter  204
cost  0.224437  at iter  205
cost  0.224437  at iter  206
cost  0.22444  at iter  207
cost  0.224436  at iter  208
cost  0.224437  at iter  209
cost  0.224436  at iter  210
cost  0.224436  at iter  211
cost  0.224434  at iter  212
cost  0.224436  at iter  213
cost  0.224437  at iter  214
cost  0.224433  at iter  215
cost  0.224436  at iter  216
cost  0.224435  at iter  217
cost  0.224431  at iter  218
cost  0.224433  at iter  219
cost  0.224434  at iter  220
cost  0.224431  at iter  221
cost  0.224431  at iter  222
cost  0.224431  at iter  223
cost  0.224431  at iter  224
cost  0.224431  at iter  225
cost  0.224431  at iter  226
cost  0.224431  at iter  227
cost  0.22443  at iter  228
cost  0.22443  at iter  229
cost  0.224429  at iter  230
cost  0.224429  at iter  231
cost  0.224428  at iter  232
cost  0.224428  at iter  233
cost  0.224429  at iter  234
cost  0.224429  at iter  235
cost  0.224428  at iter  236
cost  0.224429  at iter  237
cost  0.224426  at iter  238
cost  0.224427  at iter  239
cost  0.224428  at iter  240
cost  0.224426  at iter  241
cost  0.224427  at iter  242
cost  0.224427  at iter  243
cost  0.224426  at iter  244
cost  0.224423  at iter  245
cost  0.224425  at iter  246
cost  0.224424  at iter  247
cost  0.224424  at iter  248
cost  0.224427  at iter  249
cost  0.224424  at iter  250
cost  0.224424  at iter  251
cost  0.224423  at iter  252
cost  0.224425  at iter  253
cost  0.224422  at iter  254
cost  0.224423  at iter  255
cost  0.224421  at iter  256
cost  0.224422  at iter  257
cost  0.224421  at iter  258
cost  0.224421  at iter  259
cost  0.22442  at iter  260
cost  0.224419  at iter  261
cost  0.224421  at iter  262
cost  0.224421  at iter  263
cost  0.224421  at iter  264
cost  0.22442  at iter  265
cost  0.22442  at iter  266
cost  0.224421  at iter  267
cost  0.224419  at iter  268
cost  0.22442  at iter  269
cost  0.22442  at iter  270
cost  0.22442  at iter  271
cost  0.224419  at iter  272
cost  0.224418  at iter  273
cost  0.22442  at iter  274
cost  0.22442  at iter  275
cost  0.224419  at iter  276
cost  0.224418  at iter  277
cost  0.224418  at iter  278
cost  0.224417  at iter  279
cost  0.224416  at iter  280
cost  0.224418  at iter  281
cost  0.224419  at iter  282
cost  0.224416  at iter  283
cost  0.224418  at iter  284
cost  0.224418  at iter  285
cost  0.224417  at iter  286
cost  0.224419  at iter  287
cost  0.224419  at iter  288
cost  0.224418  at iter  289
cost  0.224418  at iter  290
cost  0.224419  at iter  291
cost  0.224418  at iter  292
cost  0.22442  at iter  293
cost  0.224421  at iter  294
cost  0.22442  at iter  295
cost  0.224419  at iter  296
cost  0.22442  at iter  297
cost  0.22442  at iter  298
cost  0.224419  at iter  299
cost  0.224419  at iter  300
cost  0.22442  at iter  301
cost  0.224421  at iter  302
cost  0.224419  at iter  303
cost  0.22442  at iter  304
cost  0.22442  at iter  305
cost  0.224421  at iter  306
cost  0.224422  at iter  307
cost  0.224421  at iter  308
cost  0.224423  at iter  309
cost  0.22442  at iter  310
cost  0.224424  at iter  311
cost  0.224422  at iter  312
cost  0.224423  at iter  313
cost  0.224426  at iter  314
cost  0.224424  at iter  315
cost  0.224423  at iter  316
cost  0.224422  at iter  317
cost  0.224425  at iter  318
cost  0.224425  at iter  319
cost  0.224424  at iter  320
cost  0.224425  at iter  321
cost  0.224425  at iter  322
cost  0.224425  at iter  323
cost  0.224425  at iter  324
cost  0.224427  at iter  325
cost  0.224427  at iter  326
cost  0.224427  at iter  327
cost  0.224428  at iter  328
cost  0.224429  at iter  329
cost  0.224428  at iter  330
cost  0.224428  at iter  331
cost  0.224429  at iter  332
cost  0.224428  at iter  333
cost  0.224428  at iter  334
cost  0.224429  at iter  335
cost  0.22443  at iter  336
cost  0.224429  at iter  337
cost  0.224429  at iter  338
cost  0.224431  at iter  339
cost  0.22443  at iter  340
cost  0.224431  at iter  341
cost  0.22443  at iter  342
cost  0.22443  at iter  343
cost  0.22443  at iter  344
cost  0.22443  at iter  345
cost  0.22443  at iter  346
cost  0.22443  at iter  347
cost  0.224431  at iter  348
cost  0.22443  at iter  349
cost  0.22443  at iter  350
cost  0.22443  at iter  351
cost  0.224432  at iter  352
cost  0.22443  at iter  353
cost  0.224432  at iter  354
cost  0.224431  at iter  355
cost  0.22443  at iter  356
cost  0.22443  at iter  357
cost  0.22443  at iter  358
cost  0.224429  at iter  359
cost  0.22443  at iter  360
cost  0.22443  at iter  361
cost  0.22443  at iter  362
cost  0.224429  at iter  363
cost  0.22443  at iter  364
cost  0.22443  at iter  365
cost  0.22443  at iter  366
cost  0.224429  at iter  367
cost  0.224431  at iter  368
cost  0.224429  at iter  369
cost  0.224429  at iter  370
cost  0.224428  at iter  371
cost  0.224429  at iter  372
cost  0.224428  at iter  373
cost  0.224428  at iter  374
cost  0.224427  at iter  375
cost  0.224429  at iter  376
cost  0.224427  at iter  377
cost  0.224429  at iter  378
cost  0.224428  at iter  379
cost  0.224426  at iter  380
cost  0.224428  at iter  381
cost  0.224426  at iter  382
cost  0.224426  at iter  383
cost  0.224427  at iter  384
cost  0.224426  at iter  385
cost  0.224426  at iter  386
cost  0.224426  at iter  387
cost  0.224425  at iter  388
cost  0.224426  at iter  389
cost  0.224426  at iter  390
cost  0.224425  at iter  391
cost  0.224425  at iter  392
cost  0.224424  at iter  393
cost  0.224424  at iter  394
cost  0.224424  at iter  395
cost  0.224424  at iter  396
cost  0.224424  at iter  397
cost  0.224423  at iter  398
cost  0.224423  at iter  399
cost  0.224423  at iter  400
cost  0.224423  at iter  401
cost  0.224423  at iter  402
cost  0.224422  at iter  403
cost  0.224423  at iter  404
cost  0.224423  at iter  405
cost  0.224421  at iter  406
cost  0.224422  at iter  407
cost  0.224422  at iter  408
cost  0.224422  at iter  409
cost  0.224422  at iter  410
cost  0.22442  at iter  411
cost  0.224421  at iter  412
cost  0.224422  at iter  413
cost  0.224421  at iter  414
cost  0.224421  at iter  415
cost  0.224422  at iter  416
cost  0.224421  at iter  417
cost  0.224421  at iter  418
cost  0.22442  at iter  419
cost  0.224422  at iter  420
cost  0.224421  at iter  421
cost  0.224421  at iter  422
cost  0.22442  at iter  423
cost  0.224421  at iter  424
cost  0.224422  at iter  425
cost  0.22442  at iter  426
cost  0.224421  at iter  427
cost  0.224421  at iter  428
cost  0.224421  at iter  429
cost  0.224421  at iter  430
cost  0.22442  at iter  431
cost  0.22442  at iter  432
cost  0.224421  at iter  433
cost  0.224421  at iter  434
cost  0.224421  at iter  435
cost  0.224422  at iter  436
cost  0.224421  at iter  437
cost  0.224422  at iter  438
cost  0.224423  at iter  439
cost  0.224421  at iter  440
cost  0.224421  at iter  441
cost  0.224422  at iter  442
cost  0.224421  at iter  443
cost  0.224422  at iter  444
cost  0.224423  at iter  445
cost  0.224422  at iter  446
cost  0.224423  at iter  447
cost  0.224424  at iter  448
cost  0.224423  at iter  449
cost  0.224423  at iter  450
cost  0.224422  at iter  451
cost  0.224421  at iter  452
cost  0.224421  at iter  453
cost  0.224425  at iter  454
cost  0.224423  at iter  455
cost  0.224423  at iter  456
cost  0.224423  at iter  457
cost  0.224421  at iter  458
cost  0.224425  at iter  459
cost  0.224422  at iter  460
cost  0.224422  at iter  461
cost  0.224423  at iter  462
cost  0.224423  at iter  463
cost  0.224422  at iter  464
cost  0.224424  at iter  465
cost  0.224423  at iter  466
cost  0.224423  at iter  467
cost  0.224423  at iter  468
cost  0.224422  at iter  469
cost  0.224424  at iter  470
cost  0.224424  at iter  471
cost  0.224424  at iter  472
cost  0.224425  at iter  473
cost  0.224425  at iter  474
cost  0.224426  at iter  475
cost  0.224425  at iter  476